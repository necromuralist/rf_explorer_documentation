<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RFE Communicator &#8212; RF-Explorer Explorations 2017.10.02.a documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tuna.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/mr_pipo_waves_small.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RFExplorer.RFECommunicator" href="autogenerated_api/RFExplorer.RFECommunicator.html" />
    <link rel="prev" title="RFExplorer.RFExplorer" href="autogenerated_api/RFExplorer.RFExplorer.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>
  
  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          RF-Explorer Explorations</a>
        <span class="navbar-text navbar-version pull-left"><b>2017.10.02</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">RF-Explorer API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">RFE Communicator</a><ul>
<li><a class="reference internal" href="#setting-up-the-device">Setting Up The Device</a><ul>
<li><a class="reference internal" href="#connecting-to-the-device">Connecting to the Device</a></li>
<li><a class="reference internal" href="#reboot-the-device">Reboot the Device</a></li>
<li><a class="reference internal" href="#loading-the-model">Loading The Model</a></li>
<li><a class="reference internal" href="#checking-the-analyzer">Checking The Analyzer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#closing-the-connection">Closing the Connection</a></li>
<li><a class="reference internal" href="#the-spectrum-frequency-values">The Spectrum Frequency Values</a></li>
<li><a class="reference internal" href="#processing-data">Processing Data</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="autogenerated_api/RFExplorer.RFExplorer.html" title="Previous Chapter: RFExplorer.RFExplorer"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; RFExplorer.RFExplorer</span>
    </a>
  </li>
  <li>
    <a href="autogenerated_api/RFExplorer.RFECommunicator.html" title="Next Chapter: RFExplorer.RFECommunicator"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">RFExplorer.RF... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/rfexplorer/rfe_communicator.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

  
  
  <div id="main-content" class="container">
    <div class="row">
      <div class="col-md-12 content">
        
  <div class="section" id="rfe-communicator">
<h1><a class="toc-backref" href="#id1">RFE Communicator</a><a class="headerlink" href="#rfe-communicator" title="Permalink to this headline">¶</a></h1>
<p>This is the main class to use when communicating with the RF Explorer.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.html#RFExplorer.RFECommunicator" title="RFExplorer.RFECommunicator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator</span></code></a>()</td>
<td>Main API class to support all basic low level operations with RF Explorer</td>
</tr>
</tbody>
</table>
<p>The link above will take you to descriptions of all the methods. The remaining sections have a sub-set of the same methods but are grouped by subjects.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#rfe-communicator" id="id1">RFE Communicator</a><ul>
<li><a class="reference internal" href="#setting-up-the-device" id="id2">Setting Up The Device</a><ul>
<li><a class="reference internal" href="#connecting-to-the-device" id="id3">Connecting to the Device</a></li>
<li><a class="reference internal" href="#reboot-the-device" id="id4">Reboot the Device</a></li>
<li><a class="reference internal" href="#loading-the-model" id="id5">Loading The Model</a></li>
<li><a class="reference internal" href="#checking-the-analyzer" id="id6">Checking The Analyzer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#closing-the-connection" id="id7">Closing the Connection</a></li>
<li><a class="reference internal" href="#the-spectrum-frequency-values" id="id8">The Spectrum Frequency Values</a></li>
<li><a class="reference internal" href="#processing-data" id="id9">Processing Data</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="setting-up-the-device">
<h2><a class="toc-backref" href="#id2">Setting Up The Device</a><a class="headerlink" href="#setting-up-the-device" title="Permalink to this headline">¶</a></h2>
<div class="section" id="connecting-to-the-device">
<h3><a class="toc-backref" href="#id3">Connecting to the Device</a><a class="headerlink" href="#connecting-to-the-device" title="Permalink to this headline">¶</a></h3>
<p>These are the two main methods I’m using right now to connect to the USB port.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.GetConnectedPorts.html#RFExplorer.RFECommunicator.GetConnectedPorts" title="RFExplorer.RFECommunicator.GetConnectedPorts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.GetConnectedPorts</span></code></a>()</td>
<td>Found the valid available serial port</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.ConnectPort.html#RFExplorer.RFECommunicator.ConnectPort" title="RFExplorer.RFECommunicator.ConnectPort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.ConnectPort</span></code></a>(sUserPort,&nbsp;nBaudRate)</td>
<td>Connect serial port and start init sequence if AutoConfigure property is set.</td>
</tr>
</tbody>
</table>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">GetConnectedPorts</span><span class="p">()</span>
<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">ConnectPort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baud_rate</span><span class="p">)):</span>
    <span class="k">raise</span> <span class="n">CommunicatorException</span><span class="p">(</span><span class="s2">&quot;Unable to connect: port=</span><span class="si">{}</span><span class="s2">, baud=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baud_rate</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="reboot-the-device">
<h3><a class="toc-backref" href="#id4">Reboot the Device</a><a class="headerlink" href="#reboot-the-device" title="Permalink to this headline">¶</a></h3>
<p>Once connected you should reboot the device by passing the string “r” to the <code class="docutils literal notranslate"><span class="pre">SendCommand</span></code> and then wait till the <code class="docutils literal notranslate"><span class="pre">IsResetEvent</span></code> property is False.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.SendCommand.html#RFExplorer.RFECommunicator.SendCommand" title="RFExplorer.RFECommunicator.SendCommand"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.SendCommand</span></code></a>(sCommand)</td>
<td>Format and send command - for instance to reboot just use “r”, the ‘#’ decorator and byte length char will be included within</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.IsResetEvent.html#RFExplorer.RFECommunicator.IsResetEvent" title="RFExplorer.RFECommunicator.IsResetEvent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.IsResetEvent</span></code></a></td>
<td>Reset string is detected.</td>
</tr>
</tbody>
</table>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="k">while</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">IsResetEvent</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-the-model">
<h3><a class="toc-backref" href="#id5">Loading The Model</a><a class="headerlink" href="#loading-the-model" title="Permalink to this headline">¶</a></h3>
<p>To start the data-stream you have to request the config data and then wait until the model has been loaded.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.SendCommand_RequestConfigData.html#RFExplorer.RFECommunicator.SendCommand_RequestConfigData" title="RFExplorer.RFECommunicator.SendCommand_RequestConfigData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.SendCommand_RequestConfigData</span></code></a>()</td>
<td>Request RF Explorer SA device to send configuration data and start sending feed back</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.ActiveModel.html#RFExplorer.RFECommunicator.ActiveModel" title="RFExplorer.RFECommunicator.ActiveModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.ActiveModel</span></code></a></td>
<td>The model active, regardless being main or expansion board</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.ProcessReceivedString.html#RFExplorer.RFECommunicator.ProcessReceivedString" title="RFExplorer.RFECommunicator.ProcessReceivedString"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.ProcessReceivedString</span></code></a>(…)</td>
<td>Processes all strings received and queued by the ReceiveThreadFunc.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFE_Common.eModel.html#RFExplorer.RFE_Common.eModel" title="RFExplorer.RFE_Common.eModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFE_Common.eModel</span></code></a></td>
<td>All possible RF Explorer model values</td>
</tr>
</tbody>
</table>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">SendCommand_RequestConfigData</span><span class="p">()</span>
<span class="k">while</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">ActiveModel</span> <span class="o">==</span> <span class="n">RFExplorer</span><span class="o">.</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">ProcessReceivedString</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="checking-the-analyzer">
<h3><a class="toc-backref" href="#id6">Checking The Analyzer</a><a class="headerlink" href="#checking-the-analyzer" title="Permalink to this headline">¶</a></h3>
<p>The example checks that the device is a spectrum analyzer (actually checks that it’s not a signal generator). This seems like it might be unnecessary, but I guess it’s safer to check.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.IsAnalyzer.html#RFExplorer.RFECommunicator.IsAnalyzer" title="RFExplorer.RFECommunicator.IsAnalyzer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.IsAnalyzer</span></code></a>([…])</td>
<td>Check if the connected object is a Spectrum Analyzer device</td>
</tr>
</tbody>
</table>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">IsAnalyzer</span><span class="p">()):</span>
    <span class="k">raise</span> <span class="n">CommunicatorError</span><span class="p">(</span><span class="s2">&quot;Error: Device connected is a Signal Generator. &quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Please, connect a Spectrum Analyzer&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="closing-the-connection">
<h2><a class="toc-backref" href="#id7">Closing the Connection</a><a class="headerlink" href="#closing-the-connection" title="Permalink to this headline">¶</a></h2>
<p>It looks like the <code class="docutils literal notranslate"><span class="pre">RFECommunicator's</span></code> destructor tries to close the Serial Connection, but it’s probably safer to explicitly close it to avoid problems.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.Close.html#RFExplorer.RFECommunicator.Close" title="RFExplorer.RFECommunicator.Close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.Close</span></code></a>()</td>
<td>End thread and close port</td>
</tr>
</tbody>
</table>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rf_explorer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rf_explorer</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rf_explorer</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="section" id="the-spectrum-frequency-values">
<h2><a class="toc-backref" href="#id8">The Spectrum Frequency Values</a><a class="headerlink" href="#the-spectrum-frequency-values" title="Permalink to this headline">¶</a></h2>
<p>These are methods to help you find out what is the range of values being collected. You can change it with some of the other methods and the SweepData only keeps track of indices so you probably need this to keep things in sync.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.CalculateCenterFrequencyMHZ.html#RFExplorer.RFECommunicator.CalculateCenterFrequencyMHZ" title="RFExplorer.RFECommunicator.CalculateCenterFrequencyMHZ"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.CalculateCenterFrequencyMHZ</span></code></a>()</td>
<td>Calculate Center Frequency in MHz</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.CalculateEndFrequencyMHZ.html#RFExplorer.RFECommunicator.CalculateEndFrequencyMHZ" title="RFExplorer.RFECommunicator.CalculateEndFrequencyMHZ"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.CalculateEndFrequencyMHZ</span></code></a>()</td>
<td>Calculates the END or STOP frequency of the span, based on Start / Step values.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.CalculateFrequencySpanMHZ.html#RFExplorer.RFECommunicator.CalculateFrequencySpanMHZ" title="RFExplorer.RFECommunicator.CalculateFrequencySpanMHZ"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.CalculateFrequencySpanMHZ</span></code></a>()</td>
<td>Calculate Step Frequency in MHz</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="processing-data">
<h2><a class="toc-backref" href="#id9">Processing Data</a><a class="headerlink" href="#processing-data" title="Permalink to this headline">¶</a></h2>
<p>I (sort of) mentioned this method in the section about setting-up the USB connection, but it’s important so I’ll call it out. The code is using a thread to write the data to a buffer (or something like one) and won’t process it so that you can get to it until you call <code class="docutils literal notranslate"><span class="pre">ProcessReceivedString</span></code>. If you pass in <code class="docutils literal notranslate"><span class="pre">False</span></code> as an argument it will only process one data-set and if you pass in <code class="docutils literal notranslate"><span class="pre">True</span></code> it will process all the data it has buffered so far.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="autogenerated_api/RFExplorer.RFECommunicator.ProcessReceivedString.html#RFExplorer.RFECommunicator.ProcessReceivedString" title="RFExplorer.RFECommunicator.ProcessReceivedString"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RFECommunicator.ProcessReceivedString</span></code></a>(…)</td>
<td>Processes all strings received and queued by the ReceiveThreadFunc.</td>
</tr>
</tbody>
</table>
</div>
</div>


      </div>
        
    </div>
  </div>
  <footer class="footer navbar-fixed-bottom">
    <div class="container" style="text-align:center">
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding: 10px" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
    </div>
  </footer>

  </body>
</html>