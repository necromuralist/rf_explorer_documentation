<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RFExplorer.RFExplorer &#8212; RF-Explorer Explorations 2017.10.02.a documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/tuna.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/mr_pipo_waves_small.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>
  
  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          RF-Explorer Explorations</a>
        <span class="navbar-text navbar-version pull-left"><b>2017.10.02</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rfexplorer/index.html">RF-Explorer API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

  
  
  <div id="main-content" class="container">
    <div class="row">
      <div class="col-md-12 content">
        
  <h1>Source code for RFExplorer.RFExplorer</h1><div class="highlight"><pre>
<span></span><span class="c1">#pylint: disable=trailing-whitespace, line-too-long, bad-whitespace, invalid-name, R0204, C0200</span>
<span class="c1">#pylint: disable=superfluous-parens, missing-docstring, broad-except</span>
<span class="c1">#pylint: disable=too-many-lines, too-many-instance-attributes, too-many-statements, too-many-nested-blocks</span>
<span class="c1">#pylint: disable=too-many-branches, too-many-public-methods, too-many-locals, too-many-arguments, duplicate-code</span>

<span class="c1">#============================================================================</span>
<span class="c1">#RF Explorer Python Libraries - A Spectrum Analyzer for everyone!</span>
<span class="c1">#Copyright Â© 2010-17 Ariel Rocholl, www.rf-explorer.com</span>
<span class="c1">#</span>
<span class="c1"># Contributed by:</span>
<span class="c1"># </span>
<span class="c1">#       Julian Calderon</span>
<span class="c1">#       John Isham</span>
<span class="c1">#</span>
<span class="c1">#This application is free software; you can redistribute it and/or</span>
<span class="c1">#modify it under the terms of the GNU Lesser General Public</span>
<span class="c1">#License as published by the Free Software Foundation; either</span>
<span class="c1">#version 3.0 of the License, or (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1">#This software is distributed in the hope that it will be useful,</span>
<span class="c1">#but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="c1">#General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1">#You should have received a copy of the GNU General Public</span>
<span class="c1">#License along with this library; if not, write to the Free Software</span>
<span class="c1">#Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class="c1">#=============================================================================</span>

<span class="kn">import</span> <span class="nn">queue</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">serial.tools.list_ports</span>
<span class="kn">import</span> <span class="nn">serial</span>

<span class="c1">#---------------------------------------------------------</span>

<span class="kn">from</span> <span class="nn">RFExplorer</span> <span class="k">import</span> <span class="n">RFE_Common</span> 
<span class="kn">from</span> <span class="nn">RFExplorer.ReceiveSerialThread</span> <span class="k">import</span> <span class="n">ReceiveSerialThread</span>
<span class="kn">from</span> <span class="nn">RFExplorer.RFESweepData</span> <span class="k">import</span> <span class="n">RFESweepData</span>
<span class="kn">from</span> <span class="nn">RFExplorer.RFESweepDataCollection</span> <span class="k">import</span> <span class="n">RFESweepDataCollection</span>
<span class="kn">from</span> <span class="nn">RFExplorer.RFEConfiguration</span> <span class="k">import</span> <span class="n">RFEConfiguration</span>
<span class="kn">from</span> <span class="nn">RFExplorer.RFEAmplitudeTableData</span> <span class="k">import</span> <span class="n">RFEAmplitudeTableData</span>
<span class="kn">from</span> <span class="nn">RFExplorer.RFE6GEN_CalibrationData</span> <span class="k">import</span> <span class="n">RFE6GEN_CalibrationData</span>

<span class="c1">#---------------------------------------------------------</span>

<div class="viewcode-block" id="Convert_mW_2_dBm"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.Convert_mW_2_dBm">[docs]</a><span class="k">def</span> <span class="nf">Convert_mW_2_dBm</span><span class="p">(</span><span class="n">mW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert mw to dBm</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mW -- Value in mW</span>
<span class="sd">    Returns:</span>
<span class="sd">        Float Value in dBm</span>
<span class="sd">    &quot;&quot;&quot;</span></div>
    <span class="k">return</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mW</span><span class="p">))</span>

<div class="viewcode-block" id="Convert_Watt_2_dBm"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.Convert_Watt_2_dBm">[docs]</a><span class="k">def</span> <span class="nf">Convert_Watt_2_dBm</span><span class="p">(</span><span class="n">Watt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert Watt to dBm</span>

<span class="sd">    Parameters:</span>
<span class="sd">        Watt -- Value in Watt</span>
<span class="sd">    Returns:</span>
<span class="sd">        Float Value in dBm</span>
<span class="sd">    &quot;&quot;&quot;</span></div>
    <span class="k">return</span> <span class="p">(</span><span class="mf">30.0</span> <span class="o">+</span> <span class="n">Convert_mW_2_dBm</span><span class="p">(</span><span class="n">Watt</span><span class="p">))</span>

<div class="viewcode-block" id="Convert_dBm_2_dBuV"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.Convert_dBm_2_dBuV">[docs]</a><span class="k">def</span> <span class="nf">Convert_dBm_2_dBuV</span><span class="p">(</span><span class="n">dBm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert dBm to dBuV</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        dBm -- Value in dBm</span>
<span class="sd">    Returns:</span>
<span class="sd">        Float Value in dBuV</span>
<span class="sd">	&quot;&quot;&quot;</span></div>
    <span class="k">return</span> <span class="p">(</span><span class="n">dBm</span> <span class="o">+</span> <span class="mf">107.0</span><span class="p">)</span>

<div class="viewcode-block" id="Convert_dBuV_2_dBm"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.Convert_dBuV_2_dBm">[docs]</a><span class="k">def</span> <span class="nf">Convert_dBuV_2_dBm</span><span class="p">(</span><span class="n">dBuV</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert dBuV to dBm</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        dBuV -- Value in dBuV</span>
<span class="sd">    Returns:</span>
<span class="sd">        Float Value in dBm</span>
<span class="sd">	&quot;&quot;&quot;</span></div>
    <span class="k">return</span> <span class="p">(</span><span class="n">dBuV</span> <span class="o">-</span> <span class="mf">107.0</span><span class="p">)</span>

<div class="viewcode-block" id="Convert_dBm_2_mW"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.Convert_dBm_2_mW">[docs]</a><span class="k">def</span> <span class="nf">Convert_dBm_2_mW</span><span class="p">(</span><span class="n">dBm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert dBm to mW</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        dBm -- Value in dBm</span>
<span class="sd">    Returns:</span>
<span class="sd">        Float Value in mW</span>
<span class="sd">	&quot;&quot;&quot;</span></div>
    <span class="k">return</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dBm</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">))</span>

<div class="viewcode-block" id="Convert_dBm_2_Watt"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.Convert_dBm_2_Watt">[docs]</a><span class="k">def</span> <span class="nf">Convert_dBm_2_Watt</span><span class="p">(</span><span class="n">dBm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert dBm to Watt</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">        dBm -- Value in dBm</span>
<span class="sd">    Returns:</span>
<span class="sd">        Float Value in Watt</span>
<span class="sd">	&quot;&quot;&quot;</span></div>
    <span class="k">return</span> <span class="p">(</span><span class="n">Convert_dBm_2_mW</span><span class="p">(</span><span class="n">dBm</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>

<div class="viewcode-block" id="DecorateSerialNumberRAWString"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.DecorateSerialNumberRAWString">[docs]</a><span class="k">def</span> <span class="nf">DecorateSerialNumberRAWString</span><span class="p">(</span><span class="n">sRAWSerialNumber</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function gives format to the serial number string as xxxx-xxxx-xxxx-xxxx </span>

<span class="sd">    Parameters:</span>
<span class="sd">        sRAWSerialNumber -- Original serial number format</span>
<span class="sd">    Returns:</span>
<span class="sd">        String changed serial number format</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sRAWSerialNumber</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sRAWSerialNumber</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">16</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">sRAWSerialNumber</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">sRAWSerialNumber</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">sRAWSerialNumber</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">sRAWSerialNumber</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span></div>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

<span class="n">g_arrModels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;UNKWN&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_433</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;433M&quot;</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_868</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;868M&quot;</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_915</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;915M&quot;</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB1G</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;WSUB1G&quot;</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_2400</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;2.4G&quot;</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB3G</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;WSUB3G&quot;</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_6G</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;6G&quot;</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_RFGEN</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;RFE6GEN&quot;</span>
<span class="n">g_arrModels</span><span class="p">[</span><span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NONE&quot;</span>

<div class="viewcode-block" id="GetModelTextFromEnum"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.GetModelTextFromEnum">[docs]</a><span class="k">def</span> <span class="nf">GetModelTextFromEnum</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a human readable and normalized identifier text for the model specified in the enum</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model -- RFExplorer model</span>
<span class="sd">    Returns:</span>
<span class="sd">	    String text identifier such as 433M or WSUB1G</span>
<span class="sd">	&quot;&quot;&quot;</span></div>
    <span class="k">return</span> <span class="n">g_arrModels</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>

<div class="viewcode-block" id="GetModelEnumFromText"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.GetModelEnumFromText">[docs]</a><span class="k">def</span> <span class="nf">GetModelEnumFromText</span><span class="p">(</span><span class="n">sText</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns model enumerator based on text provided</span>

<span class="sd">    Parameters:</span>
<span class="sd">        sText -- One of &quot;433M&quot;, &quot;868M&quot;, &quot;915M&quot;, &quot;WSUB1G&quot;, &quot;2.4G&quot;, &quot;WSUB3G&quot;, &quot;6G&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        RFE_Common.eModel Valid model enumerator or will set to MODEL_NONE if not found</span>
<span class="sd">	&quot;&quot;&quot;</span>
    <span class="n">eReturn</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span>

    <span class="k">for</span> <span class="n">nInd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g_arrModels</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sText</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">g_arrModels</span><span class="p">[</span><span class="n">nInd</span><span class="p">]):</span>
            <span class="n">eReturn</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="p">(</span><span class="n">nInd</span><span class="p">)</span>
            <span class="k">break</span>
</div>
    <span class="k">return</span> <span class="n">eReturn</span>

<span class="c1">#---------------------------------------------------------</span>

<div class="viewcode-block" id="RFECommunicator"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator">[docs]</a><span class="k">class</span> <span class="nc">RFECommunicator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>    
    <span class="sd">&quot;&quot;&quot;Main API class to support all basic low level operations with RF Explorer</span>
<span class="sd">	&quot;&quot;&quot;</span>
<div class="viewcode-block" id="RFECommunicator.__init__"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFECommunicator.html#RFExplorer.RFECommunicator.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bAutoCleanConfig</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseByteBLOB</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseStringBLOB</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bAutoConfigure</span> <span class="o">=</span> <span class="kc">True</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrConnectedPorts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nVerboseLevel</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bIsResetEvent</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_hQueueLock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_hSerialPortLock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_ReceivedBytesMutex</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bDisposed</span> <span class="o">=</span> <span class="kc">False</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fStartFrequencyMHZ</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fStepFrequencyMHZ</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRefFrequencyMHZ</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nFreqSpectrumSteps</span> <span class="o">=</span> <span class="mi">112</span>  <span class="c1">#$S byte buffer by default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fOffset_dB</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fThresholdDBM</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRBWKHZ</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStartFrequencyMHZ</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenCWFrequencyMHZ</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStepFrequencyMHZ</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStopFrequencyMHZ</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenStartHighPowerSwitch</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenSweepSteps</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenHighPowerSwitch</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStepWaitMS</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenPowerLevel</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStopPowerLevel</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenStopHighPowerSwitch</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenPowerON</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fMinSpanMHZ</span> <span class="o">=</span> <span class="mf">0.112</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fPeakValueAmp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">120.0</span>   
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fMaxSpanMHZ</span> <span class="o">=</span> <span class="mf">100.0</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fMinFreqMHZ</span> <span class="o">=</span> <span class="mf">430.0</span>       
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fMaxFreqMHZ</span> <span class="o">=</span> <span class="mf">440.0</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fPeakValueMHZ</span> <span class="o">=</span> <span class="mf">0.0</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeTopDBM</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>       <span class="c1">#dBm for top graph limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseMaxHold</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStartPowerLevel</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#offset values read from spectrum analyzer calibration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bMainboardInternalCalibrationAvailable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bExpansionBoardInternalCalibrationAvailable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerEmbeddedCalibrationOffsetDB</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerExpansionCalibrationOffsetDB</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeBottomDBM</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_MIN_AMPLITUDE_DBM</span>   <span class="c1">#dBm for bottom graph limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_SPECTRUM_ANALYZER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bStoreSweep</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_spanAverageSpeedAcumulator</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fAverageSweepTime</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nAverageSweepSpeedIterator</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bAcknowledge</span> <span class="o">=</span> <span class="kc">False</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bIntendedAnalyzer</span> <span class="o">=</span> <span class="kc">True</span>     
        <span class="bp">self</span><span class="o">.</span><span class="n">m_eDSP</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eDSP</span><span class="o">.</span><span class="n">DSP_AUTO</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_sSerialNumber</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_sSweepInfoText</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>     
        <span class="bp">self</span><span class="o">.</span><span class="n">m_eMainBoardModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_eExpansionBoardModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_eCalculator</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eCalculator</span><span class="o">.</span><span class="n">NORMAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bExpansionBoardActive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_sSerialNumber</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_sExpansionSerialNumber</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nBaudrate</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRunReceiveThread</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bHoldMode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_sDebugAllReceivedBytes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>        <span class="c1">#Debug string for all received bytes record.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_sRFExplorerFirmware</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>       <span class="c1">#Detected firmware</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRetriesCalibration</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_RFGenCal</span> <span class="o">=</span> <span class="n">RFE6GEN_CalibrationData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_FileAmplitudeCalibration</span> <span class="o">=</span> <span class="n">RFEAmplitudeTableData</span><span class="p">()</span>   <span class="c1">#This variable contains the latest correction file loaded</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_SweepDataContainer</span> <span class="o">=</span> <span class="n">RFESweepDataCollection</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_objQueue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_objThread</span> <span class="o">=</span> <span class="n">ReceiveSerialThread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_objQueue</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_hQueueLock</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_hSerialPortLock</span><span class="p">)</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_objThread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#print(&quot;destructor called&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Dispose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">AutoCleanConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True if SweepData collection clean automatically, otherwise False</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bAutoCleanConfig</span>
    <span class="nd">@AutoCleanConfig</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">AutoCleanConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bAutoCleanConfig</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RunReceiveThread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True if thread is running, otherwise False </span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bRunReceiveThread</span>
    <span class="nd">@RunReceiveThread</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RunReceiveThread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRunReceiveThread</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">SweepData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The main and only data collection with all the Sweep accumulated data</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_SweepDataContainer</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">IsResetEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset string is detected. When is check in the get property, is set automatically to false. </span>
<span class="sd">        We detect the last reset</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bIsResetEvent</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_bIsResetEvent</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bIsResetEvent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">VerboseLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Debug trace level for print console messages 1-10 being 10 the most verbose</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nVerboseLevel</span>
    <span class="nd">@VerboseLevel</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">VerboseLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nVerboseLevel</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Calculator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the currently configured calculator in the device</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eCalculator</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">UseByteBLOB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/Set</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseByteBLOB</span>
    <span class="nd">@UseByteBLOB</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">UseByteBLOB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseByteBLOB</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">UseStringBLOB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/Set</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseStringBLOB</span>
    <span class="nd">@UseStringBLOB</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">UseStringBLO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseStringBLOB</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">PortConnected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Will be True while COM port is connected, as Serial.IsOpen() is not reliable</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span>
    <span class="nd">@PortConnected</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">PortConnected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>       
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">DebugAllReceivedBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Debug string collection for all bytes received from device</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_ReceivedBytesMutex</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">sReturn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_sDebugAllReceivedBytes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_ReceivedBytesMutex</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sReturn</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">UseMaxHold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True if Max Hold is used, otherwise False </span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseMaxHold</span>
    <span class="nd">@UseMaxHold</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">UseMaxHold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>    
        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseMaxHold</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_SetMaxHold</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Calculator</span> <span class="o">!=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eCalculator</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_Realtime</span><span class="p">()</span> <span class="c1">#avoid sending it again if already in normal mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bUseMaxHold</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">SweepInfoText</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Human readable text with time of last capture as well as average sweep time and sweeps / second</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_sSweepInfoText</span>

    <span class="c1">#Initializer for 433MHz model, will change later based on settings  </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MinSpanMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Min valid span in MHZ for connected model</span>
<span class="sd">		&quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fMinSpanMHZ</span>
    <span class="nd">@MinSpanMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MinSpanMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fMinSpanMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MaxSpanMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Max valid span in MHZ for connected model</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fMaxSpanMHZ</span>
    <span class="nd">@MaxSpanMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MaxSpanMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fMaxSpanMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MinFreqMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Min valid frequency in MHZ for connected mode</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fMinFreqMHZ</span>
    <span class="nd">@MinFreqMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MinFreqMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fMinFreqMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MaxFreqMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Max valid frequency in MHZ for connected model</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fMaxFreqMHZ</span>
    <span class="nd">@MaxFreqMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MaxFreqMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fMaxFreqMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">PeakValueMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Last drawing iteration peak value MHZ read</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fPeakValueMHZ</span>
    <span class="nd">@PeakValueMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">PeakValueMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fPeakValueMHZ</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">PeakValueAmplitudeDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Last drawing iteration peak value dBm read</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fPeakValueAmp</span>
    <span class="nd">@PeakValueAmplitudeDBM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">PeakValueAmplitudeDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fPeakValueAmp</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">AmplitudeTopDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This is the highest value that should be selected for display, includes Offset dBm</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeTopDBM</span>
    <span class="nd">@AmplitudeTopDBM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">AmplitudeTopDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeTopDBM</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">AmplitudeTopNormalizedDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;AmplitudeTop property includes the offset dBm, the normalized one does not</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeTopDBM</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fOffset_dB</span>
    <span class="nd">@AmplitudeTopNormalizedDBM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">AmplitudeTopNormalizedDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeTopDBM</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fOffset_dB</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">AmplitudeBottomDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This is the lowest value that should be selected for display, includes Offset dBm</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeBottomDBM</span>
    <span class="nd">@AmplitudeBottomDBM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">AmplitudeBottomDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeBottomDBM</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">AmplitudeBottomNormalizedDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;AmplitudeBottom property includes the offset dBm, the normalized one does not</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeBottomDBM</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fOffset_dB</span>
    <span class="nd">@AmplitudeBottomNormalizedDBM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">AmplitudeBottomNormalizedDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fAmplitudeBottomDBM</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fOffset_dB</span>

    <span class="c1">#spectrum analyzer configuration</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">StartFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Frequency in MHZ for the span start position, </span>
<span class="sd">        used to calculate all other positions together with StepFrequencyMHZ</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fStartFrequencyMHZ</span>
    <span class="nd">@StartFrequencyMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">StartFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fStartFrequencyMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">StepFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Analyzer sweep frequency step in MHZ</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fStepFrequencyMHZ</span>
    <span class="nd">@StepFrequencyMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">StepFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fStepFrequencyMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">StopFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculated span stop frequency in MHZ</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fStartFrequencyMHZ</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fStepFrequencyMHZ</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">FreqSpectrumSteps</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenStartPowerLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/Set amplitude sweep start value for Signal Generator Power Level (0-3)</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStartPowerLevel</span>
    <span class="nd">@RFGenStartPowerLevel</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenStartPowerLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStartPowerLevel</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">FreqSpectrumSteps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;$S byte buffer by default</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nFreqSpectrumSteps</span>
    <span class="nd">@FreqSpectrumSteps</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">FreqSpectrumSteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nFreqSpectrumSteps</span> <span class="o">=</span> <span class="n">value</span> 
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RefFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reference frequency used for sniffer decoder and other zero span functions</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fRefFrequencyMHZ</span> 
    <span class="nd">@RefFrequencyMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RefFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRefFrequencyMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1">#Signal generator configuration</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenStartFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/Set Signal Generator sweep start frequency in MHZ.</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStartFrequencyMHZ</span>
    <span class="nd">@RFGenStartFrequencyMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenStartFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStartFrequencyMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenCWFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/Set Signal Generator CW frequency in MHZ.</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenCWFrequencyMHZ</span>
    <span class="nd">@RFGenCWFrequencyMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenCWFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenCWFrequencyMHZ</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenStepFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/Set Signal Generator sweep step frequency in MHZ.</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStepFrequencyMHZ</span>
    <span class="nd">@RFGenStepFrequencyMHZ</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenStepFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStepFrequencyMHZ</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>    
    <span class="k">def</span> <span class="nf">RFGenStopFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get/Set Signal Generator sweep stop frequency in MHZ.</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStopFrequencyMHZ</span>
    <span class="nd">@RFGenStopFrequencyMHZ</span><span class="o">.</span><span class="n">setter</span>    
    <span class="k">def</span> <span class="nf">RFGenStopFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fRFGenStopFrequencyMHZ</span> <span class="o">=</span> <span class="n">value</span> 
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenSweepSteps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get/Set Signal Generator sweep steps with valid values in 2-9999.</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenSweepSteps</span>
    <span class="nd">@RFGenSweepSteps</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenSweepSteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenSweepSteps</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenStepWaitMS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
        <span class="sd">&quot;&quot;&quot; Get/Set Signal Generator sweep step wait delay in Milliseconds, with a limit of 65,535 max.</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStepWaitMS</span> 
    <span class="nd">@RFGenStepWaitMS</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenStepWaitMS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStepWaitMS</span> <span class="o">=</span> <span class="n">value</span> 

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenHighPowerSwitch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get/Set Signal Generator High Power switch. </span>
<span class="sd">        This is combined with RFGenHighPowerSwitch in order to define power level for a CW or Sweep command</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenHighPowerSwitch</span>
    <span class="nd">@RFGenHighPowerSwitch</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenHighPowerSwitch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenHighPowerSwitch</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenPowerLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get/Set Signal Generator power level status (0-3). </span>
<span class="sd">        This is combined with RFGenHighPowerSwitch in order to define power level for a CW or Sweep command</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenPowerLevel</span>
    <span class="nd">@RFGenPowerLevel</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenPowerLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenPowerLevel</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenPowerON</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get/Set Signal Generator power on status.</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenPowerON</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenStartHighPowerSwitch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/Set amplitude sweep start value for Signal Generator High Power Switch</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenStartHighPowerSwitch</span>
    <span class="nd">@RFGenStartHighPowerSwitch</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenStartHighPowerSwitch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenStartHighPowerSwitch</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenStopHighPowerSwitch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get/Set amplitude sweep stop value for Signal Generator High Power Switch</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenStopHighPowerSwitch</span>
    <span class="nd">@RFGenStopHighPowerSwitch</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenStopHighPowerSwitch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenStopHighPowerSwitch</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFGenStopPowerLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get/Set amplitude sweep stop value for Signal Generator Power Level (0-3)</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStopPowerLevel</span>
    <span class="nd">@RFGenStopPowerLevel</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">RFGenStopPowerLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenStopPowerLevel</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MainBoardModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The RF model installed in main board</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eMainBoardModel</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ExpansionBoardActive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True when the expansion board is active, false otherwise</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bExpansionBoardActive</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">BaudRate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get/Set the baudrate for modulation modes such as Sniffer. Note it may be actual baudrate or sample rate depending on modulation type</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nBaudrate</span>
    <span class="nd">@BaudRate</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">BaudRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>    
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nBaudrate</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Acknowledged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>     
        <span class="sd">&quot;&quot;&quot;Everytime we check the acknowledge, it reset itself to false</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="n">bTemp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bAcknowledge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bAcknowledge</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">bTemp</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ActiveModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
        <span class="sd">&quot;&quot;&quot;The model active, regardless being main or expansion board</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">AmplitudeOffsetDB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;Manual offset of the amplitude reading to compensate external adjustments</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fOffset_dB</span>
    <span class="nd">@AmplitudeOffsetDB</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">AmplitudeOffsetDB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fOffset_dB</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">AutoConfigure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;Auto configure is true by default and is used for the communicator to auto request config data to RFE upon port connection</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bAutoConfigure</span>
    <span class="nd">@AutoConfigure</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">AutoConfigure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bAutoConfigure</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ExpansionBoardModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;The RF model installed in the expansion board</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eExpansionBoardModel</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ExpansionSerialNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;Serial number for the expansion board, if any.</span>
<span class="sd">		&quot;&quot;&quot;</span>    
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_sExpansionSerialNumber</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DecorateSerialNumberRAWString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_sExpansionSerialNumber</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">HoldMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot;Get or Set Hold mode state</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bHoldMode</span>
    <span class="nd">@HoldMode</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">HoldMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bHoldMode</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">FirmwareCertified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The currently certified firmware</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_RFEXPLORER_FIRMWARE_CERTIFIED</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the current operational mode </span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">PortName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;String for name of COM Port</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">port</span> 
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RBW_KHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;RBW in KHZ currently in use, both in analyzer and sniffer</span>
<span class="sd">		&quot;&quot;&quot;</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fRBWKHZ</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">RFExplorerFirmwareDetected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get detected firmware, otherwise &quot;N/A&quot; </span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_sRFExplorerFirmware</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;N/A&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_sRFExplorerFirmware</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">SerialNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Serial number for the device (main board)</span>
<span class="sd">		&quot;&quot;&quot;</span>    
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_sSerialNumber</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">return</span> <span class="n">DecorateSerialNumberRAWString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_sSerialNumber</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">StoreSweep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;It gets or sets the capacity to store multiple historical sweep data in the &lt;see cref&gt;SweepData&lt;/ref&gt; collection</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bStoreSweep</span>
    <span class="nd">@StoreSweep</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">StoreSweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">m_bStoreSweep</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ThresholdDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Threshold in dBm used for alarm, sniffer capture, etc</span>
<span class="sd">		&quot;&quot;&quot;</span>    
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fThresholdDBM</span>
    <span class="nd">@ThresholdDBM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ThresholdDBM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_fThresholdDBM</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">IsMWSUB3G</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Property true if the WSUB3G connected is actually a MWSUB3G. This enables us to work with MWSUB3G same as WSUB3G except </span>
<span class="sd">           in specific places where MWSUB3G code is required. Use this function anytime to know if a WSUB3G is actually a MWSUB3G</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMainBoardModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB3G</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eExpansionBoardModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span><span class="p">))</span>

<div class="viewcode-block" id="RFECommunicator.ProcessReceivedString"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.ProcessReceivedString">[docs]</a>    <span class="k">def</span> <span class="nf">ProcessReceivedString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bProcessAllEvents</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Processes all strings received and queued by the ReceiveThreadFunc.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            bProcessAllEvents -- If this is False then only one event will be processed, otherwise will do all that are waiting on the queue</span>
<span class="sd">        Returns:</span>
<span class="sd">            Boolean Returns true if an event was received requiring redraw</span>
<span class="sd">            String the last processed string from the queue</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="n">bDraw</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">sReceivedString</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>     
                <span class="n">nCount</span> <span class="o">=</span> <span class="mi">1</span>   
                <span class="k">while</span><span class="p">(</span><span class="n">bProcessAllEvents</span> <span class="ow">and</span> <span class="n">nCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">bWrongFormat</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">objNew</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_hQueueLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span> 
                        <span class="n">nCount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_objQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">nCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> 
                            <span class="k">break</span>
                        <span class="n">objNew</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_objQueue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>                       
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">obEx</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nVerboseLevel</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> 
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m_arrReceivedStrings processing: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obEx</span><span class="p">))</span>
                    <span class="k">finally</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_hQueueLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">objNew</span><span class="p">,</span> <span class="n">RFEConfiguration</span><span class="p">)):</span>
                        <span class="n">objConfiguration</span> <span class="o">=</span> <span class="n">objNew</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nVerboseLevel</span><span class="o">&gt;</span><span class="mi">4</span><span class="p">:</span> 
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Received configuration: &quot;</span> <span class="o">+</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">LineString</span><span class="p">)</span>

                        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsGenerator</span><span class="p">()):</span>
                            <span class="c1">#it is a signal generator</span>
                            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_RFGenCal</span><span class="o">.</span><span class="n">GetCalSize</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                                <span class="c1">#request internal calibration data, if available</span>
                                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nRetriesCalibration</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">):</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;Cq&quot;</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_nRetriesCalibration</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="c1">#signal generator</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">Mode</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenPowerON</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bRFEGenPowerON</span>
                            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_GEN_CW</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenCWFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fRFEGenCWFreqMHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStepMHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenPowerLevel</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenPowerLevel</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenHighPowerSwitch</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bRFEGenHighPowerSwitch</span>

                            <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_GEN_SWEEP_FREQ</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStartMHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStepMHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenSweepSteps</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nFreqSpectrumSteps</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopFrequencyMHZ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartFrequencyMHZ</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenSweepSteps</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepFrequencyMHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenPowerLevel</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenPowerLevel</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenHighPowerSwitch</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bRFEGenHighPowerSwitch</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepWaitMS</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenSweepWaitMS</span>
                            <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_GEN_SWEEP_AMP</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenCWFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fRFEGenCWFreqMHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartHighPowerSwitch</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bRFEGenStartHighPowerSwitch</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartPowerLevel</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenStartPowerLevel</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopHighPowerSwitch</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bRFEGenStopHighPowerSwitch</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopPowerLevel</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenStopPowerLevel</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepWaitMS</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenSweepWaitMS</span>
                            <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_NONE</span><span class="p">):</span>
                                <span class="k">if</span> <span class="p">(</span><span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStartMHZ</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                                    <span class="c1">#if RFE_Common.eMode.MODE_NONE and fStartMHZ has some meaningful value, it means</span>
                                    <span class="c1">#we are receiving a C3-* full status update</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenCWFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fRFEGenCWFreqMHZ</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenHighPowerSwitch</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bRFEGenHighPowerSwitch</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStartMHZ</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStepMHZ</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenSweepSteps</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nFreqSpectrumSteps</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopFrequencyMHZ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartFrequencyMHZ</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenSweepSteps</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepFrequencyMHZ</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenPowerLevel</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenPowerLevel</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartHighPowerSwitch</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bRFEGenStartHighPowerSwitch</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartPowerLevel</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenStartPowerLevel</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopHighPowerSwitch</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bRFEGenStopHighPowerSwitch</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopPowerLevel</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenStopPowerLevel</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepWaitMS</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nRFEGenSweepWaitMS</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unknown Signal Generator configuration received&quot;</span><span class="p">)</span>

                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">pass</span>

                            <span class="bp">self</span><span class="o">.</span><span class="n">MinFreqMHZ</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_RFGEN_MIN_FREQ_MHZ</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">MaxFreqMHZ</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_RFGEN_MAX_FREQ_MHZ</span>

                            <span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eMainBoardModel</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1">#it is an spectrum analyzer</span>
                            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerEmbeddedCalibrationOffsetDB</span><span class="p">):</span>
                                <span class="c1">#request internal calibration data, if available</span>
                                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nRetriesCalibration</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">):</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;Cq&quot;</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">baudrate</span> <span class="o">&lt;</span> <span class="mi">115200</span><span class="p">):</span>
                                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_nRetriesCalibration</span> <span class="o">+=</span> <span class="mi">1</span>

                            <span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">Mode</span>

                            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">!=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_SNIFFER</span><span class="p">):</span>
                                <span class="k">if</span> <span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">StartFrequencyMHZ</span> <span class="o">-</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStartMHZ</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.001</span><span class="p">)</span> <span class="ow">or</span> 
                                        <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">StepFrequencyMHZ</span> <span class="o">-</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStepMHZ</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.001</span><span class="p">)):</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">StartFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStartMHZ</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">StepFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStepMHZ</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Freq range - buffer cleared.&quot;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">AmplitudeTopDBM</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fAmplitudeTopDBM</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">AmplitudeBottomDBM</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fAmplitudeBottomDBM</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">FreqSpectrumSteps</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nFreqSpectrumSteps</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_bExpansionBoardActive</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">bExpansionBoardActive</span>
                            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bExpansionBoardActive</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eExpansionBoardModel</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eMainBoardModel</span>

                            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB3G</span><span class="p">):</span>
                                <span class="c1">#If it is a MODEL_WSUB3G, make sure we use the MAX HOLD mode to account for proper DSP</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_eCalculator</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">eCalculator</span>
                                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> 
                                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bUseMaxHold</span><span class="p">):</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eCalculator</span> <span class="o">!=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eCalculator</span><span class="o">.</span><span class="n">MAX_HOLD</span><span class="p">):</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated remote mode to Max Hold for reliable DSP calculations with fast signals&quot;</span><span class="p">)</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_SetMaxHold</span><span class="p">()</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eCalculator</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eCalculator</span><span class="o">.</span><span class="n">MAX_HOLD</span><span class="p">):</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Remote mode is not Max Hold, some fast signals may not be detected&quot;</span><span class="p">)</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_Realtime</span><span class="p">()</span>


                            <span class="k">if</span> <span class="p">(</span><span class="n">objConfiguration</span><span class="o">.</span><span class="n">Mode</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_SNIFFER</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_nBaudrate</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nBaudrate</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_fThresholdDBM</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fThresholdDBM</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_fRefFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStartMHZ</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1">#spectrum analyzer</span>
                                <span class="k">if</span> <span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">StartFrequencyMHZ</span> <span class="o">-</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStartMHZ</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.001</span><span class="p">)</span> <span class="ow">or</span>
                                        <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">StepFrequencyMHZ</span> <span class="o">-</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStepMHZ</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.001</span><span class="p">)):</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">StartFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStartMHZ</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">StepFrequencyMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fStepMHZ</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New Freq range - buffer cleared.&quot;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">AmplitudeTopDBM</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fAmplitudeTopDBM</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">AmplitudeBottomDBM</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fAmplitudeBottomDBM</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">FreqSpectrumSteps</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nFreqSpectrumSteps</span>
                                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB3G</span><span class="p">):</span>
                                    <span class="c1">#If it is a MODEL_WSUB3G, make sure we use the MAX HOLD mode to account for proper DSP</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_eCalculator</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">eCalculator</span>
                                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bUseMaxHold</span><span class="p">):</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eCalculator</span> <span class="o">!=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eCalculator</span><span class="o">.</span><span class="n">MAX_HOLD</span><span class="p">):</span>
                                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated remote mode to Max Hold for reliable DSP calculations with fast signals&quot;</span><span class="p">)</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_SetMaxHold</span><span class="p">()</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eCalculator</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eCalculator</span><span class="o">.</span><span class="n">MAX_HOLD</span><span class="p">):</span>
                                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Remote mode is not Max Hold, some fast signals may not be detected&quot;</span><span class="p">)</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_Realtime</span><span class="p">()</span>

                                <span class="bp">self</span><span class="o">.</span><span class="n">MinFreqMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fMinFreqMHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">MaxFreqMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fMaxFreqMHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">MaxSpanMHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fMaxSpanMHZ</span>

                                <span class="bp">self</span><span class="o">.</span><span class="n">m_fOffset_dB</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fOffset_dB</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_fRBWKHZ</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">fRBWKHZ</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">FreqSpectrumSteps</span> <span class="o">=</span> <span class="n">objConfiguration</span><span class="o">.</span><span class="n">nFreqSpectrumSteps</span>

                                <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_2400</span><span class="p">)</span>
                                        <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_6G</span><span class="p">)):</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">MinSpanMHZ</span> <span class="o">=</span> <span class="mf">2.0</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">MinSpanMHZ</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">FreqSpectrumSteps</span>
                            <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AutoCleanConfig</span><span class="p">):</span>
                                <span class="c1">#print(&quot;count before clean:(ProcessReceivedString): &quot; + str(self.m_SweepDataContainer.Count))</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_SweepDataContainer</span><span class="o">.</span><span class="n">CleanAll</span><span class="p">()</span>
                                <span class="c1">#print(&quot;count after clean:(ProcessReceivedString): &quot; + str(self.m_SweepDataContainer.Count))</span>
                    <span class="c1">#Check if Sweep data case</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">objNew</span><span class="p">,</span> <span class="n">RFESweepData</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">!=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_TRACKING</span><span class="p">):</span>
                            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bHoldMode</span><span class="p">):</span>
                                <span class="n">objSweep</span> <span class="o">=</span> <span class="n">objNew</span>
                                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bStoreSweep</span><span class="p">):</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_SweepDataContainer</span><span class="o">.</span><span class="n">CleanAll</span><span class="p">()</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_SweepDataContainer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">objSweep</span><span class="p">)</span>
                                <span class="c1">#print(&quot;Added sweep &quot; + str(self.m_SweepDataContainer.Count))</span>

                                <span class="n">bDraw</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_SweepDataContainer</span><span class="o">.</span><span class="n">IsFull</span><span class="p">()):</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_bHoldMode</span> <span class="o">=</span> <span class="kc">True</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RAM Buffer is full.&quot;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_sSweepInfoText</span> <span class="o">=</span> <span class="s2">&quot;Captured:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">objSweep</span><span class="o">.</span><span class="n">CaptureTime</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; - Data points:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">objSweep</span><span class="o">.</span><span class="n">TotalSteps</span><span class="p">)</span>
                                <span class="n">objSpan</span> <span class="o">=</span> <span class="n">objSweep</span><span class="o">.</span><span class="n">CaptureTime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span>  
                                <span class="k">if</span> <span class="p">(</span><span class="n">objSpan</span><span class="o">.</span><span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">):</span>
                                    <span class="c1">#if time between captures is less than 60</span>
                                    <span class="c1">#seconds, we can assume we are getting</span>
                                    <span class="c1">#realtime data</span>
                                    <span class="c1">#and therefore can provide average</span>
                                    <span class="c1">#sweep/seconds information, otherwise we</span>
                                    <span class="c1">#were in hold or something</span>
                                    <span class="c1">#and data could not be used for these</span>
                                    <span class="c1">#calculations.</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_nAverageSweepSpeedIterator</span> <span class="o">+=</span> <span class="mi">1</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_spanAverageSpeedAcumulator</span> <span class="o">+=</span> <span class="p">(</span><span class="n">objSweep</span><span class="o">.</span><span class="n">CaptureTime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_fAverageSweepTime</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">m_sSweepInfoText</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sweep time: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_fAverageSweepTime</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; seconds&quot;</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_fAverageSweepTime</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">):</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">m_sSweepInfoText</span> <span class="o">+=</span> <span class="s2">&quot; - Avg Sweeps/second: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_fAverageSweepTime</span><span class="p">))</span> <span class="c1">#add this only for fast, short duration scans</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nAverageSweepSpeedIterator</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">):</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">m_fAverageSweepTime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_spanAverageSpeedAcumulator</span><span class="o">.</span><span class="n">seconds</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nAverageSweepSpeedIterator</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">m_nAverageSweepSpeedIterator</span> <span class="o">=</span> <span class="mi">0</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">m_spanAverageSpeedAcumulator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span> <span class="c1">#set it to zero and start average all over again</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span> <span class="o">=</span> <span class="n">objSweep</span><span class="o">.</span><span class="n">CaptureTime</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1">#if in hold mode, we just record last time came</span>
                                <span class="c1">#here to make sure we start from most reliable</span>
                                <span class="c1">#point in time</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>  
                    <span class="c1">#Nothing specific, so just consider individual cases</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sLine</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">objNew</span><span class="p">)</span>
                        <span class="n">sReceivedString</span> <span class="o">=</span> <span class="n">sLine</span>
                        <span class="k">if</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_ACKNOWLEDGE</span><span class="p">)):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_bAcknowledge</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DSP:&quot;</span><span class="p">)):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_eDSP</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eDSP</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DSP mode: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eDSP</span><span class="p">))</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#Sn&quot;</span><span class="p">)):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_sSerialNumber</span> <span class="o">=</span> <span class="n">sLine</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Device serial number: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_sSerialNumber</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;$q&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;$Q&quot;</span><span class="p">))):</span>
                            <span class="c1">#calibration data</span>
                            <span class="n">nSourceStringSize</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">):</span>
                                <span class="n">nSourceStringSize</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="mh">0x100</span> <span class="o">*</span> <span class="n">sLine</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

                            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsGenerator</span><span class="p">()):</span>
		                        <span class="c1">#signal generator uses a different approach for storing absolute amplitude value offset over an ideal -30dBm response</span>
                                <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m_RFGenCal</span><span class="o">.</span><span class="n">GetCalSize</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_RFGenCal</span><span class="o">.</span><span class="n">GetCalSize</span><span class="p">()</span> <span class="o">!=</span> <span class="n">nSourceStringSize</span><span class="p">)):</span>
                                    <span class="n">sData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_RFGenCal</span><span class="o">.</span><span class="n">InitializeCal</span><span class="p">(</span><span class="n">nSourceStringSize</span><span class="p">,</span> <span class="n">sLine</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Embedded calibration Signal Generator data received: &quot;</span> <span class="o">+</span> <span class="n">sData</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_6G</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB1G</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB1G_PLUS</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsMWSUB3G</span><span class="p">):</span>
                                <span class="n">sData</span> <span class="o">=</span> <span class="s2">&quot;Embedded calibration Spectrum Analyzer data received:&quot;</span>
                                <span class="n">bAllZero</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="n">nStartPositionCalData</span> <span class="o">=</span> <span class="mi">0</span>
                                <span class="n">nStopPositionCalData</span> <span class="o">=</span> <span class="n">nSourceStringSize</span>
                                <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_6G</span><span class="p">):</span>
                                    <span class="n">nStartPositionCalData</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_POS_INTERNAL_CALIBRATED_6G</span>
                                <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB1G</span><span class="p">):</span>
                                    <span class="n">nStartPositionCalData</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_POS_INTERNAL_CALIBRATED_WSUB1G</span>
                                    <span class="n">nStopPositionCalData</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_POS_END_INTERNAL_CALIBRATED_WSUB1G</span>
                                <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB1G_PLUS</span><span class="p">):</span>
                                    <span class="n">nStartPositionCalData</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_POS_INTERNAL_CALIBRATED_WSUB1G_PLUS</span>
                                    <span class="n">nStopPositionCalData</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_POS_END_INTERNAL_CALIBRATED_WSUB1G_PLUS</span>
                                <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eActiveModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_WSUB3G</span><span class="p">):</span>
                                    <span class="n">nStartPositionCalData</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_POS_INTERNAL_CALIBRATED_MWSUB3G</span>

                                <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerEmbeddedCalibrationOffsetDB</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerEmbeddedCalibrationOffsetDB</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">nStopPositionCalData</span> <span class="o">-</span> <span class="n">nStartPositionCalData</span><span class="p">))):</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerEmbeddedCalibrationOffsetDB</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">nStopPositionCalData</span> <span class="o">-</span> <span class="n">nStartPositionCalData</span><span class="p">)</span>
                                    
                                <span class="n">nAdjustSize</span> <span class="o">=</span> <span class="mi">3</span>
                                <span class="k">if</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">):</span>
                                    <span class="n">nAdjustSize</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1">#this accounts for extra byte sent in $Q for size</span>
                                <span class="n">nInd2</span> <span class="o">=</span> <span class="mi">0</span>
                                <span class="k">for</span> <span class="n">nInd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nStartPositionCalData</span><span class="p">,</span> <span class="n">nStopPositionCalData</span><span class="p">):</span>
                                    <span class="k">if</span> <span class="p">(((</span><span class="n">nInd2</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span><span class="p">(</span><span class="n">sData</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))):</span>
                                        <span class="n">sData</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                                        <span class="n">nInd2</span> <span class="o">=</span> <span class="mi">0</span>
                                    <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsMWSUB3G</span> <span class="ow">and</span> <span class="p">((</span><span class="n">nInd</span> <span class="o">%</span> <span class="mi">81</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span><span class="p">(</span><span class="n">sData</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))):</span>
                                        <span class="n">sData</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                                        <span class="n">nInd2</span> <span class="o">=</span> <span class="mi">0</span>

                                    <span class="n">nVal</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="n">nInd</span> <span class="o">+</span> <span class="n">nAdjustSize</span><span class="p">])</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="n">nVal</span> <span class="o">&gt;</span> <span class="mi">127</span><span class="p">):</span>
                                        <span class="n">nVal</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">256</span> <span class="o">-</span> <span class="n">nVal</span><span class="p">)</span>  <span class="c1">#get the right sign</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="n">nVal</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                                        <span class="n">bAllZero</span> <span class="o">=</span> <span class="kc">False</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerEmbeddedCalibrationOffsetDB</span><span class="p">[</span><span class="n">nInd</span> <span class="o">-</span> <span class="n">nStartPositionCalData</span><span class="p">]</span> <span class="o">=</span> <span class="n">nVal</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="c1">#split by two to get dB</span>
                                    <span class="n">sData</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:04.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerEmbeddedCalibrationOffsetDB</span><span class="p">[</span><span class="n">nInd</span> <span class="o">-</span> <span class="n">nStartPositionCalData</span><span class="p">])</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="n">nInd</span> <span class="o">&lt;</span> <span class="n">nStopPositionCalData</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                                        <span class="n">sData</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span>
                                    <span class="n">nInd2</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">sData</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">sData</span><span class="p">)</span>
                                <span class="k">if</span> <span class="p">(</span><span class="n">bAllZero</span><span class="p">):</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: the device internal calibration data is missing! contact support at www.rf-explorer.com/contact&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sLine</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#C2-M:&quot;</span><span class="p">):</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Received RF Explorer device model info:&quot;</span> <span class="o">+</span> <span class="n">sLine</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_eMainBoardModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]))</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_eExpansionBoardModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">]))</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_sRFExplorerFirmware</span> <span class="o">=</span> <span class="n">sLine</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sLine</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#C3-M:&quot;</span><span class="p">):</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Received RF Explorer Generator device info:&quot;</span> <span class="o">+</span> <span class="n">sLine</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_eMainBoardModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]))</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_eExpansionBoardModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">]))</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_sRFExplorerFirmware</span> <span class="o">=</span> <span class="n">sLine</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sLine</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#CAL:&quot;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_bMainboardInternalCalibrationAvailable</span> <span class="o">=</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_bExpansionBoardInternalCalibrationAvailable</span> <span class="o">=</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">18</span><span class="p">]</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_RESETSTRING</span><span class="p">)):</span>
                            <span class="c1">#RF Explorer device was reset for some reason, reconfigure client based on new configuration</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">m_bIsResetEvent</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;$S&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">StartFrequencyMHZ</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)):</span>
                            <span class="n">bWrongFormat</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sLine</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#C4-F:&quot;</span><span class="p">))):</span>
                            <span class="n">bWrongFormat</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1">#parsed on the thread</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#C2-F:&quot;</span><span class="p">)):</span>
                            <span class="n">bWrongFormat</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1">#parsed on the thread</span>
                        <span class="k">elif</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sLine</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#C1-F:&quot;</span><span class="p">)):</span>
                            <span class="n">bWrongFormat</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1">#obsolete firmware</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">sLine</span><span class="p">)</span>  <span class="c1">#report any line we don&#39;t understand - it is likely a human readable message</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">bWrongFormat</span><span class="p">):</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Received unexpected data from RFExplorer device:&quot;</span> <span class="o">+</span> <span class="n">sLine</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please update your RF Explorer to a recent firmware version and&quot;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;make sure you are using the latest version of RF Explorer for Windows.&quot;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Visit http://www.rf-explorer/download for latest firmware updates.&quot;</span><span class="p">)</span>


            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">obEx</span><span class="p">:</span>
                <span class="c1">#print(&quot;ProcessReceivedString: &quot; + sReceivedString + &#39;\n&#39; + str(obEx))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ProcessReceivedString: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obEx</span><span class="p">))</span>
</div>
        <span class="k">return</span> <span class="n">bDraw</span><span class="p">,</span> <span class="n">sReceivedString</span>
            
<div class="viewcode-block" id="RFECommunicator.IsAnalyzerEmbeddedCal"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.IsAnalyzerEmbeddedCal">[docs]</a>    <span class="k">def</span> <span class="nf">IsAnalyzerEmbeddedCal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; As a function of expansion or mainboard being currently selected, returns true if there is internal</span>
<span class="sd">        calibration data available, or false if not.</span>
<span class="sd">        IMPORTANT: the calibration data is not returned immediately after connection and that may make think</span>
<span class="sd">        the calibration is not available. </span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            True if calibration is embedded, otherwise false</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExpansionBoardActive</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bExpansionBoardInternalCalibrationAvailable</span>
        <span class="k">else</span><span class="p">:</span></div>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bMainboardInternalCalibrationAvailable</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_Realtime"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_Realtime">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_Realtime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set RF Explorer SA devince in Calculator:Normal, this is useful to</span>
<span class="sd">        minimize spikes and spurs produced by unwanted signals</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;C+</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span>
    
<div class="viewcode-block" id="RFECommunicator.SendCommand_SetMaxHold"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_SetMaxHold">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_SetMaxHold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set RF Explorer SA device in Calculator:MaxHold, this is useful to capture fast transient signals even if the actual Windows application is representing other trace modes</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;C+</span><span class="se">\x04</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.CalculateCenterFrequencyMHZ"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.CalculateCenterFrequencyMHZ">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateCenterFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate Center Frequency in MHz </span>

<span class="sd">        Returns:</span>
<span class="sd">            Float Center frequency in MHz</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">StartFrequencyMHZ</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalculateFrequencySpanMHZ</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span>

<div class="viewcode-block" id="RFECommunicator.CalculateFrequencySpanMHZ"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.CalculateFrequencySpanMHZ">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateFrequencySpanMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate Step Frequency in MHz </span>

<span class="sd">        Returns:</span>
<span class="sd">            Float Span frequency in MHz</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">StepFrequencyMHZ</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">FreqSpectrumSteps</span>

<div class="viewcode-block" id="RFECommunicator.CalculateEndFrequencyMHZ"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.CalculateEndFrequencyMHZ">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateEndFrequencyMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the END or STOP frequency of the span, based on Start / Step values.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Float end frequency in MHz</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">StartFrequencyMHZ</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">StepFrequencyMHZ</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">FreqSpectrumSteps</span>

<div class="viewcode-block" id="RFECommunicator.IsGenerator"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.IsGenerator">[docs]</a>    <span class="k">def</span> <span class="nf">IsGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bCheckModelAvailable</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True if is a generator, otherwise False</span>

<span class="sd">        Parameters:</span>
<span class="sd">            bCheckModelAvailable -- Use this to &quot;true&quot; in case you want to check actual model, not intended model if still not known - By default you will want this on &quot;false&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            Boolean True if connected device is a generator, False otherwise</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">bCheckModelAvailable</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MainBoardModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span><span class="p">):</span>
                <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bIntendedAnalyzer</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">MainBoardModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_RFGEN</span>
        <span class="k">else</span><span class="p">:</span></div>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">MainBoardModel</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_RFGEN</span>

<div class="viewcode-block" id="RFECommunicator.IsAnalyzer"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.IsAnalyzer">[docs]</a>    <span class="k">def</span> <span class="nf">IsAnalyzer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bCheckModelAvailable</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the connected object is a Spectrum Analyzer device</span>

<span class="sd">        Parameters:</span>
<span class="sd">            bCheckModelAvailable -- Use this to &quot;true&quot; in case you want to check actual model, not intended model if still not known - By default you will want this on &quot;false&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">		    Boolean True if connected device is an analyzer, False otherwise</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">bCheckModelAvailable</span><span class="p">):</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsGenerator</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span></div>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MainBoardModel</span> <span class="o">!=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span><span class="p">)</span>

    <span class="c1">#region COM port low level details</span>
<div class="viewcode-block" id="RFECommunicator.GetConnectedPorts"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.GetConnectedPorts">[docs]</a>    <span class="k">def</span> <span class="nf">GetConnectedPorts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Found the valid available serial port</span>

<span class="sd">        Returns:</span>
<span class="sd">            Boolean True if it found valid available serial port, False otherwise</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="n">bOk</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">sValidPorts</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_arrConnectedPorts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">serial</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">list_ports</span><span class="o">.</span><span class="n">comports</span><span class="p">())</span>
            <span class="c1">#print(str(len(self.m_arrConnectedPorts)))</span>
            <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrConnectedPorts</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detected COM ports:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">objPort</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_arrConnectedPorts</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  * &quot;</span> <span class="o">+</span> <span class="n">objPort</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">objPort</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_arrConnectedPorts</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsConnectedPort</span><span class="p">(</span><span class="n">objPort</span><span class="o">.</span><span class="n">device</span><span class="p">)):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">objPort</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">objPort</span><span class="o">.</span><span class="n">device</span> <span class="o">+</span> <span class="s2">&quot; is a valid available port.&quot;</span><span class="p">)</span>
                        <span class="n">sValidPorts</span> <span class="o">+=</span> <span class="n">objPort</span><span class="o">.</span><span class="n">device</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                
                <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RF Explorer Valid Ports found: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="n">sValidPorts</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>   
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: not found valid COM Ports&quot;</span><span class="p">)</span> 
                    <span class="n">bOk</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Serial ports not detected&quot;</span><span class="p">)</span>
                <span class="n">bOk</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">obEx</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error scanning COM ports: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obEx</span><span class="p">))</span>
            <span class="n">bOk</span> <span class="o">=</span> <span class="kc">False</span>   
        </div>
        <span class="k">return</span> <span class="n">bOk</span>

<div class="viewcode-block" id="RFECommunicator.IsConnectedPort"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.IsConnectedPort">[docs]</a>    <span class="k">def</span> <span class="nf">IsConnectedPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sPortName</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True if it is possible connect to specific port, otherwise False </span>
<span class="sd">            </span>
<span class="sd">        Parameters:</span>
<span class="sd">            sPortName -- Serial port name, can take any form accepted by OS</span>
<span class="sd">        Returns:</span>
<span class="sd">            Boolean True if it is possible connect to specific port, otherwise False</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">baudrate</span> <span class="o">=</span> <span class="mi">500000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">sPortName</span>
        <span class="n">bOpen</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_hSerialPortLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">obEx</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in RFCommunicator - IsConnectedPort()&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obEx</span><span class="p">))</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">is_open</span><span class="p">):</span>
                <span class="n">bOpen</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_hSerialPortLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</div>
        <span class="k">return</span> <span class="n">bOpen</span>

<div class="viewcode-block" id="RFECommunicator.ConnectPort"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.ConnectPort">[docs]</a>    <span class="k">def</span> <span class="nf">ConnectPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sUserPort</span><span class="p">,</span> <span class="n">nBaudRate</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect serial port and start init sequence if AutoConfigure property is set. Connect automatically</span>
<span class="sd">        if sUserPort is None and there is only one available serial port, otherwise show an error message</span>

<span class="sd">        Parameters:</span>
<span class="sd">            sUserPort -- Serial port name, can take any form accepted by OS</span>
<span class="sd">            nBaudRate -- Usually 500000 or 2400, can be -1 to not define it and take default setting</span>
<span class="sd">        Returns:</span>
<span class="sd">		    Boolean True if port is open, otherwise False</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="n">bConnected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nVerboseLevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">sErrorText</span> <span class="o">=</span> <span class="s2">&quot;User COM port: &quot;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">sUserPort</span><span class="p">):</span>
                <span class="n">sErrorText</span> <span class="o">+=</span> <span class="n">sUserPort</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sErrorText</span> <span class="o">+=</span> <span class="s2">&quot;void&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">sErrorText</span><span class="p">)</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_hSerialPortLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">if</span><span class="p">(</span><span class="n">sUserPort</span><span class="p">):</span>                              
                <span class="k">for</span> <span class="n">sPort</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">sUserPort</span> <span class="o">==</span> <span class="n">sPort</span><span class="o">.</span><span class="n">device</span><span class="p">):</span>
                        <span class="n">sPortName</span> <span class="o">=</span> <span class="n">sUserPort</span>
                        <span class="n">bConnected</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">sPortName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">device</span>
                <span class="n">bConnected</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">objPort</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">objPort</span><span class="o">.</span><span class="n">device</span> <span class="o">==</span> <span class="s2">&quot;/dev/ttyAMA0&quot;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">objPort</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">sPortName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_arrValidCP2102Ports</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">device</span>
                    <span class="n">bConnected</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Automatically selected port&quot;</span> <span class="o">+</span> <span class="n">sPortName</span> <span class="o">+</span><span class="s2">&quot; - ttyAMA0 ignored&quot;</span><span class="p">)</span>
         
            <span class="k">if</span><span class="p">(</span><span class="n">bConnected</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">baudrate</span> <span class="o">=</span> <span class="n">nBaudRate</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">sPortName</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">bytesize</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">EIGHTBITS</span>   
                <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">stopbits</span><span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">STOPBITS_ONE</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">Parity</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">PARITY_NONE</span>   
                <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">100</span>  

                <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_bHoldMode</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Connected: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">baudrate</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; bauds&quot;</span><span class="p">)</span>

                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bAutoConfigure</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_RequestConfigData</span><span class="p">()</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>             
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: select a different COM port&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">obEx</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR ConnectPort: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obEx</span><span class="p">))</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_hSerialPortLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">is_open</span>   
        
<div class="viewcode-block" id="RFECommunicator.ClosePort"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.ClosePort">[docs]</a>    <span class="k">def</span> <span class="nf">ClosePort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Close port and initialize some settings</span>

<span class="sd">        Returns:</span>
<span class="sd">            Boolean True if serial port was closed, False otherwise</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_hSerialPortLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">is_open</span><span class="p">):</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsAnalyzer</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">==</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_SNIFFER</span><span class="p">):</span>
						<span class="c1">#Force device to configure in Analyzer mode if disconnected - C0 will be ignored so we send full config again</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;C2-F:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">StartFrequencyMHZ</span> <span class="o">*</span> <span class="mf">1000.0</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CalculateEndFrequencyMHZ</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span>
                                         <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AmplitudeTopDBM</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AmplitudeBottomDBM</span><span class="p">))</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">!=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_SPECTRUM_ANALYZER</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">!=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_SNIFFER</span><span class="p">):</span>
						<span class="c1">#If current mode is not analyzer, send C0 to force it</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_RequestConfigData</span><span class="p">()</span>

                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_Hold</span><span class="p">()</span> <span class="c1">#Switch data dump to off</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">baudrate</span> <span class="o">&lt;</span> <span class="mi">115200</span><span class="p">):</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_GeneratorRFPowerOFF</span><span class="p">()</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_ScreenON</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand_DisableScreenDump</span><span class="p">()</span>

                <span class="c1">#Close the port</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Disconnected.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#do this here so the external event has the right port status</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">finally</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">m_hSerialPortLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1">#to be double safe in case of exception</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_eMainBoardModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_eExpansionBoardModel</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eModel</span><span class="o">.</span><span class="n">MODEL_NONE</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_LastCaptureTime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">000</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">m_sSerialNumber</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_sExpansionSerialNumber</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_nRetriesCalibration</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerEmbeddedCalibrationOffsetDB</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_arrSpectrumAnalyzerExpansionCalibrationOffsetDB</span> <span class="o">=</span> <span class="kc">None</span>
</div>
        <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">is_open</span><span class="p">)</span>
    
<div class="viewcode-block" id="RFECommunicator.UpdateDeviceConfig"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.UpdateDeviceConfig">[docs]</a>    <span class="k">def</span> <span class="nf">UpdateDeviceConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fStartMHZ</span><span class="p">,</span> <span class="n">fEndMHZ</span><span class="p">,</span> <span class="n">fTopDBM</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fBottomDBM</span><span class="o">=-</span><span class="mi">120</span><span class="p">,</span> <span class="n">fRBW_KHZ</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a new configuration to the connected device</span>

<span class="sd">        Parameters:</span>
<span class="sd">            fStartMHZ  -- New start frequency, in MHZ, must be in valid range for the device</span>
<span class="sd">            fEndMHZ    -- New stop frequency, in MHZ, must be in valid range for the device</span>
<span class="sd">            fTopDBM    -- Optional, only impact visual not real data</span>
<span class="sd">            fBottomDBM -- Optional, only impact visual not real data</span>
<span class="sd">            fRBW_KHZ   -- Reserved future firmware support </span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bPortConnected</span><span class="p">):</span>
            <span class="c1"># #[32]C2-F:Sssssss,Eeeeeee,tttt,bbbb</span>
            <span class="n">nStartKhz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fStartMHZ</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="n">nEndKhz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fEndMHZ</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="n">nTopDBM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fTopDBM</span><span class="p">)</span>
            <span class="n">nBottomDBM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fBottomDBM</span><span class="p">)</span>

            <span class="n">sTopDBM</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:03d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nTopDBM</span><span class="p">)</span>
            <span class="n">sBottomDBM</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:03d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nBottomDBM</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sTopDBM</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">):</span>
                <span class="n">sTopDBM</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="n">sTopDBM</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sBottomDBM</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">):</span>
                <span class="n">sBottomDBM</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="n">sBottomDBM</span>
            <span class="n">sData</span> <span class="o">=</span> <span class="s2">&quot;C2-F:&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:07d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nStartKhz</span><span class="p">)</span><span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:07d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nEndKhz</span><span class="p">)</span><span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">sTopDBM</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">sBottomDBM</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">fRBW_KHZ</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">fRBW_KHZ</span> <span class="o">&gt;=</span> <span class="mf">3.0</span> <span class="ow">and</span> <span class="n">fRBW_KHZ</span> <span class="o">&lt;=</span> <span class="mf">670.0</span><span class="p">):</span>
                <span class="n">nSteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">fEndMHZ</span> <span class="o">-</span> <span class="n">fStartMHZ</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="n">fRBW_KHZ</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nSteps</span> <span class="o">&lt;</span> <span class="mi">112</span><span class="p">):</span>
                    <span class="n">nSteps</span> <span class="o">=</span> <span class="mi">112</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nSteps</span> <span class="o">&gt;</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_MAX_SPECTRUM_STEPS</span><span class="p">):</span>
                    <span class="n">nSteps</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">CONST_MAX_SPECTRUM_STEPS</span>
                <span class="n">fRBW_KHZ</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">fEndMHZ</span> <span class="o">-</span> <span class="n">fStartMHZ</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">nSteps</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">fRBW_KHZ</span> <span class="o">&gt;=</span> <span class="mf">3.0</span> <span class="ow">and</span> <span class="n">fRBW_KHZ</span> <span class="o">&lt;=</span> <span class="mf">620.0</span><span class="p">):</span>
                    <span class="n">sData</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:05d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nSteps</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ignored RBW &quot;</span> <span class="o">+</span> <span class="n">fRBW_KHZ</span> <span class="o">+</span> <span class="s2">&quot;Khz&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="n">sData</span><span class="p">)</span>

            <span class="c1">#wait some time for the unit to process changes, otherwise may get a different command too soon</span></div>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_RequestConfigData"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_RequestConfigData">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_RequestConfigData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request RF Explorer SA device to send configuration data and start sending feed back</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_Hold"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_Hold">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_Hold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ask RF Explorer SA device to hold</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;CH&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_GeneratorRFPowerOFF"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_GeneratorRFPowerOFF">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_GeneratorRFPowerOFF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set RF Explorer RFGen device RF power output to OFF</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsGenerator</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenPowerON</span> <span class="o">=</span> <span class="kc">False</span></div>
            <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;CP0&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_GeneratorRFPowerON"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_GeneratorRFPowerON">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_GeneratorRFPowerON</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set RF Explorer RFGen device RF power output to ON</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsGenerator</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenPowerON</span> <span class="o">=</span> <span class="kc">True</span></div>
            <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;CP1&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_DisableScreenDump"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_DisableScreenDump">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_DisableScreenDump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disable device LCD screen dump</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;D0&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_ScreenON"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_ScreenON">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_ScreenON</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable LCD and backlight on device screen (according to internal device configuration settings)</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;L1&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_ScreenOFF"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_ScreenOFF">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_ScreenOFF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disable LCD and backlight on device screen</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;L0&quot;</span><span class="p">)</span>
    
<div class="viewcode-block" id="RFECommunicator.SendCommand_GeneratorCW"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_GeneratorCW">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_GeneratorCW</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start CW generation using current configuration setting values - only valid for Signal Generator models</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsGenerator</span><span class="p">()):</span></div>
            <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;C3-F:&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:07d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenCWFrequencyMHZ</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetRFGenPowerString</span><span class="p">())</span>   
    
<div class="viewcode-block" id="RFECommunicator.SendCommand_GeneratorSweepAmplitude"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_GeneratorSweepAmplitude">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_GeneratorSweepAmplitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start Sweep Amplitude generation using current configuration setting values - only valid for Signal Generator models</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsGenerator</span><span class="p">()):</span>
            <span class="n">sSteps</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:04d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenSweepSteps</span><span class="p">)</span>

            <span class="n">sStartPower</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartHighPowerSwitch</span><span class="p">):</span>
                <span class="n">sStartPower</span> <span class="o">+=</span> <span class="s2">&quot;1,&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sStartPower</span> <span class="o">+=</span> <span class="s2">&quot;0,&quot;</span>
            <span class="n">sStartPower</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartPowerLevel</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span>

            <span class="n">sStopPower</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopHighPowerSwitch</span><span class="p">):</span>
                <span class="n">sStopPower</span> <span class="o">+=</span> <span class="s2">&quot;1,&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sStopPower</span> <span class="o">+=</span> <span class="s2">&quot;0,&quot;</span>
            <span class="n">sStopPower</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopPowerLevel</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;C3-A:&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:07d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenCWFrequencyMHZ</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span> <span class="o">+</span> <span class="n">sStartPower</span> <span class="o">+</span> <span class="n">sSteps</span> <span class="o">+</span>\</div>
                <span class="n">sStopPower</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:05d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepWaitMS</span><span class="p">))</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand_GeneratorSweepFreq"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_GeneratorSweepFreq">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_GeneratorSweepFreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bTracking</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start Sweep Freq generation using current configuration setting values - only valid for Signal Generator models</span>

<span class="sd">        Parameters:</span>
<span class="sd">            bTracking -- Default is False, set it to &#39;True&#39; to enable SNA tracking mode in generator</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IsGenerator</span><span class="p">()):</span>
            <span class="n">sSteps</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:04d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenSweepSteps</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span>

            <span class="n">dStepMHZ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenTrackStepMHZ</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dStepMHZ</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">return</span>

            <span class="n">sCommand</span> <span class="o">=</span> <span class="s2">&quot;C3-&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">bTracking</span><span class="p">):</span>
                <span class="n">sCommand</span> <span class="o">+=</span> <span class="s1">&#39;T&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_eMode</span> <span class="o">=</span> <span class="n">RFE_Common</span><span class="o">.</span><span class="n">eMode</span><span class="o">.</span><span class="n">MODE_NONE</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sCommand</span> <span class="o">+=</span> <span class="s1">&#39;F&#39;</span>
            <span class="n">sCommand</span> <span class="o">+=</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:07d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartFrequencyMHZ</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetRFGenPowerString</span><span class="p">()</span> <span class="o">+</span> <span class="n">sSteps</span> <span class="o">+</span>\
                <span class="s2">&quot;</span><span class="si">{:07d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dStepMHZ</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span><span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:07d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenStepWaitMS</span><span class="p">)</span>
</div>
            <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="n">sCommand</span><span class="p">)</span>
        
<div class="viewcode-block" id="RFECommunicator.RFGenTrackStepMHZ"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.RFGenTrackStepMHZ">[docs]</a>    <span class="k">def</span> <span class="nf">RFGenTrackStepMHZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configured tracking step size in MHZ</span>

<span class="sd">        Returns: </span>
<span class="sd">            Float Tracking step size in MHz</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenStopFrequencyMHZ</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenStartFrequencyMHZ</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">RFGenSweepSteps</span>
    
<div class="viewcode-block" id="RFECommunicator.SendCommand_SweepDataPoints"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand_SweepDataPoints">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand_SweepDataPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nDataPoints</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Define RF Explorer SA sweep data points</span>

<span class="sd">        Parameters:</span>
<span class="sd">            nDataPoints -- A value in the range of 16-4096, note a value multiple of 16 will be used, so any other number will be truncated to nearest 16 multiple</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;CJ&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nDataPoints</span> <span class="o">/</span> <span class="mi">16</span><span class="p">)))</span>

<div class="viewcode-block" id="RFECommunicator.SendCommand"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.SendCommand">[docs]</a>    <span class="k">def</span> <span class="nf">SendCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sCommand</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format and send command - for instance to reboot just use &quot;r&quot;, the &#39;#&#39; decorator and byte length char will be included within</span>
<span class="sd">         </span>
<span class="sd">        Parameters: www.rf-explorer.com/API </span>
<span class="sd">            sCommand -- Unformatted command from http://www.rf-explorer.com/API</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="n">sCompleteCommand</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sCommand</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sCommand</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sCompleteCommand</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nVerboseLevel</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">:</span></div>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RFE Command: #(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sCompleteCommand</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span> <span class="o">+</span> <span class="n">sCommand</span> <span class="o">+</span> <span class="s2">&quot; [&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:02X}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sCompleteCommand</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">)</span>
    
<div class="viewcode-block" id="RFECommunicator.ResetInternalBuffers"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.ResetInternalBuffers">[docs]</a>    <span class="k">def</span> <span class="nf">ResetInternalBuffers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use this function to internally re-initialize the MaxHold buffers used for cache data inside the RF Explorer device</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="c1">#we use this method to internally restore capture buffers to empty status</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">SendCommand</span><span class="p">(</span><span class="s2">&quot;Cr&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.CleanReceivedBytes"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.CleanReceivedBytes">[docs]</a>    <span class="k">def</span> <span class="nf">CleanReceivedBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clean and reset all debug internal received data bytes</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_ReceivedBytesMutex</span><span class="o">.</span><span class="n">WaitOne</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_sDebugAllReceivedBytes</span><span class="o">=</span><span class="s2">&quot;&quot;</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_ReceivedBytesMutex</span><span class="o">.</span><span class="n">ReleaseMutex</span><span class="p">()</span>
   
<div class="viewcode-block" id="RFECommunicator.Dispose"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.Dispose">[docs]</a>    <span class="k">def</span> <span class="nf">Dispose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bDisposing</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Local dispose method</span>

<span class="sd">        Parameters:</span>
<span class="sd">            bDisposing -- If disposing is required</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bDisposed</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">bDisposing</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">is_open</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_objSerialPort</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_ReceivedBytesMutex</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">m_ReceivedBytesMutex</span> <span class="o">=</span> <span class="kc">None</span></div>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_bDisposed</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="RFECommunicator.Close"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.Close">[docs]</a>    <span class="k">def</span> <span class="nf">Close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;End thread and close port</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bRunReceiveThread</span><span class="p">):</span>
            <span class="c1">#print(&quot;Close(): close thread&quot;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_bRunReceiveThread</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_objThread</span> <span class="o">=</span> <span class="kc">None</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">ClosePort</span><span class="p">()</span>
    
<div class="viewcode-block" id="RFECommunicator.GetSignalGeneratorEstimatedAmplitude"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.GetSignalGeneratorEstimatedAmplitude">[docs]</a>    <span class="k">def</span> <span class="nf">GetSignalGeneratorEstimatedAmplitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dFrequencyMHZ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns best matching amplitude value</span>

<span class="sd">        Parameters:</span>
<span class="sd">            dFrequencyMHZ -- frequency in MHz to get estimate the amplitude from</span>
<span class="sd">        Returns:</span>
<span class="sd">            Float Best matching amplitude value</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_RFGenCal</span><span class="o">.</span><span class="n">GetEstimatedAmplitude</span><span class="p">(</span><span class="n">dFrequencyMHZ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_bRFGenHighPowerSwitch</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nRFGenPowerLevel</span><span class="p">)</span>

<div class="viewcode-block" id="RFECommunicator.GetRFGenPowerString"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.GetRFGenPowerString">[docs]</a>    <span class="k">def</span> <span class="nf">GetRFGenPowerString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a string with the power level </span>

<span class="sd">        Returns:</span>
<span class="sd">            String Power level</span>
<span class="sd">		&quot;&quot;&quot;</span>
        <span class="n">sPower</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenHighPowerSwitch</span><span class="p">):</span>
            <span class="n">sPower</span> <span class="o">+=</span> <span class="s2">&quot;1,&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sPower</span> <span class="o">+=</span> <span class="s2">&quot;0,&quot;</span>
        <span class="n">sPower</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RFGenPowerLevel</span><span class="p">)</span>
</div>
        <span class="k">return</span> <span class="n">sPower</span>

<div class="viewcode-block" id="RFECommunicator.GetRFE6GENCal"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.GetRFE6GENCal">[docs]</a>    <span class="k">def</span> <span class="nf">GetRFE6GENCal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get RFE6Gen calibration data</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            RFE6GEN_CalibrationData Calibration data object</span>
<span class="sd">		&quot;&quot;&quot;</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_RFGenCal</span>
    
<div class="viewcode-block" id="RFECommunicator.GetAmplitudeCorrectionDB"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.GetAmplitudeCorrectionDB">[docs]</a>    <span class="k">def</span> <span class="nf">GetAmplitudeCorrectionDB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nMHz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the current correction amplitude value for a given MHZ frequency</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">            nMHz -- Frequency reference in MHZ to get correction data from</span>
<span class="sd">        Returns:</span>
<span class="sd">            Float Amplitude correction data in dB</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_FileAmplitudeCalibration</span><span class="o">.</span><span class="n">GetAmplitudeCalibration</span><span class="p">(</span><span class="n">nMHz</span><span class="p">)</span>
        
<div class="viewcode-block" id="RFECommunicator.ResetIOT_HW"><a class="viewcode-back" href="../../rfexplorer/autogenerated_api/RFExplorer.RFExplorer.html#RFExplorer.RFECommunicator.ResetIOT_HW">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ResetIOT_HW</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bMode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Raspberry pi GPIO pins and reset RF Explorer device</span>

<span class="sd">        Parameters: </span>
<span class="sd">            bMode -- True if the baudrate is set to 500000bps, False to 2400bps</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">RPi.GPIO</span> <span class="k">as</span> <span class="nn">GPIO</span>
       
            <span class="c1">#print(&quot;RPi info: &quot; + str(GPIO.RPI_INFO)) #information about your RPi:</span>
            <span class="c1">#print(&quot;RPi.GPio version: &quot; + GPIO.VERSION) #version of RPi.GPIO:</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">setwarnings</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">setmode</span><span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">BOARD</span><span class="p">)</span>    <span class="c1">#refer to the pin numbers on the P1 header of the Raspberry Pi board</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>    <span class="c1">#set /reset (pin 12) to output </span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>      <span class="c1">#set /reset (pin 12) to LOW</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>    <span class="c1">#set GPIO2 (pin 21) to output</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">bMode</span><span class="p">)</span>      <span class="c1">#set GPIO2 (pin 21) to HIGH (for 500Kbps)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>             <span class="c1">#wait 100ms</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>       <span class="c1">#set /reset to HIGH</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>             <span class="c1">#wait 2.5sec</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>     <span class="c1">#set GPIO2 to input</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>              <span class="c1">#clean up GPIO channels </span>

        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span></div></div>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error importing RPi.GPIO!  This is probably because you need superuser privileges.  You can achieve this by using &#39;sudo&#39; to run your script&quot;</span><span class="p">)</span>
 
</pre></div>

      </div>
        
    </div>
  </div>
  <footer class="footer navbar-fixed-bottom">
    <div class="container" style="text-align:center">
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="padding: 10px" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
    </div>
  </footer>

  </body>
</html>